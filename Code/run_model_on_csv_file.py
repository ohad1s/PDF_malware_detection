import joblib
import pandas as pd
import pickle
from sklearn.metrics import accuracy_score, recall_score, f1_score

# load CSV file as a Pandas DataFrame
data = pd.read_csv(
    r'C:\Users\dvir1\Desktop\לימודים אריאל\סמסטר חורף שנה ג\שיטות לגילוי התקפות סייבר\PDF_malware_detection\dataSet\clean_1000_dataSet.csv')

# extract features from DataFrame (e.g., assume X contains the features and y contains the labels)

# X = data[['feature1', 'feature2', ...]]
X = data.drop('FileName', axis=1)
X = X.drop('Header', axis=1)
X = X.drop('Colors', axis=1)
X = X.drop('Label', axis=1)
# X = X.drop('Trailer', axis=1)
# X = X.drop('EndObj', axis=1)
# X = X.drop('EndStream', axis=1)
# X = X.drop('EmbeddedFiles', axis=1)
# X = X.drop('PageNo', axis=1)
# X = X.drop('JS', axis=1)
# X = X.drop('IsEncrypted', axis=1)


y = data['Label']

# load pickled machine learning model (e.g., assume it's saved as "model.pkl")
model = joblib.load('random_forest.pkl')

# make predictions using the loaded model and extracted features
predictions = model.predict(X)

# print the predictions
print(predictions)
# calculate accuracy, recall, and F1 score for the predictions
accuracy = accuracy_score(y, predictions)
recall = recall_score(y, predictions)
f1 = f1_score(y, predictions)

# print the accuracy, recall, and F1 score
print("Accuracy: {:.3f}".format(accuracy))
print("Recall: {:.3f}".format(recall))
print("F1 score: {:.3f}".format(f1))
