import joblib
import pandas as pd
from sklearn.metrics import accuracy_score, recall_score, f1_score

# load CSV file as a Pandas DataFrame
data = pd.read_csv(
    r'C:\Users\dvir1\Desktop\לימודים אריאל\סמסטר חורף שנה ג\שיטות לגילוי התקפות סייבר\PDF_malware_detection\dataSet\clean_1000_dataSet.csv')
# put here your csv file and you extract fetures with dataset to csv val_clean(r"pdfs")

X = data.drop('FileName', axis=1)
X = X.drop('Header', axis=1)
X = X.drop('Colors', axis=1)
X = X.drop('Label', axis=1)

y = data['Label']

# load pickled machine learning model
model = joblib.load('random_forest.pkl')

# make predictions using the loaded model and extracted features
predictions = model.predict(X)

# print the predictions
print(predictions)
# calculate accuracy, recall, and F1 score for the predictions
accuracy = accuracy_score(y, predictions)
recall = recall_score(y, predictions)
f1 = f1_score(y, predictions)

# print the accuracy, recall, and F1 score
print("Accuracy: {:.3f}".format(accuracy))
print("Recall: {:.3f}".format(recall))
print("F1 score: {:.3f}".format(f1))
