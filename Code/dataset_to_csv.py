import os

import pandas as pd

from Feature_Extractor import Feature_Extractor

header= ['FileName', 'PDFSize', 'MetadataSize', 'Pages', 'XrefLength', 'TitleCharacters',
                'IsEncrypted', 'EmbeddedFiles', 'Images', 'Text', 'Header', 'Obj',
                'EndObj', 'Stream', 'EndStream', 'Xref', 'Trailer', 'StartXref', 'PageNo', 'Encrypt',
                'ObjStm', 'JS', 'Javascript', 'AA', 'OpenAction', 'Acroform', 'JBIG2Decode', 'RichMedia',
                'Launch', 'EmbeddedFile', 'XFA', 'Colors','Label']


def create_row(label, file_path):
    fe = Feature_Extractor(file_path)
    file_data = fe.main()
    file_data.append(label)
    return pd.DataFrame([file_data], columns=header)

def main(folder):
    df = pd.DataFrame(columns=header)
    files = [os.path.join(folder, f) for f in os.listdir(folder)]
    for file in files:
        try:
            row_df = create_row(1, file)
            df = pd.concat([df, row_df], ignore_index=True)
        except:
            print(f"{file} have prob")
    df.to_csv('f22_dataSet.csv',encoding='utf-8',index=False)

if __name__ == '__main__':
    main(r"/home/kali/Desktop/cyber/RR22")
