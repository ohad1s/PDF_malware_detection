import os
from run_model import Run_Model

counter = 0
clean = 0
mal = 0


def val_clean(path):
    global counter
    global clean
    global mal
    files = [os.path.join(path, f) for f in os.listdir(path)]
    for file in files:
        counter += 1
        print("%5s %10s" % ("PROCESSNG ", file))
        try:
            rm = Run_Model(file)
            pred = rm.main()
            if pred[0] == 0:
                clean += 1
            else:
                mal += 1
        except:
            mal += 1


val_clean(
    r"C:\Users\dvir1\Desktop\לימודים אריאל\סמסטר חורף שנה ג\שיטות לגילוי התקפות סייבר\PDF_malware_detection\Code\pdfs")  # put here your csv file and you extract fetures with dataset to csv
# val_clean(r"pdfs")

print(f"files: {counter}- mal: {mal}, clean: {clean}, accuracy: {clean / counter}")
